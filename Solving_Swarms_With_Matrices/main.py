import search
import mcts
import matplotlib.pyplot as plt
import numpy as np

HOR = 10
size_x = 7
size_y = 8
pests_1 = {'H': 0, 'M': 2, 'L': 1}
pests_2 = {'M': 2, 'L': 1}
PESTS = {'TOP': 7, 'H': 4, 'M': 2, 'L': 1}
NUM_OF_DRONES = 4
NUM_OF_SWARMS = 3
PROBS = {
"a11": {'TOP': 0.05, 'H': 0.05, 'M': 0.3333, 'L': 0.0625},
"a12": {'TOP': 0.0714, 'H': 0.0769, 'M': 0.25, 'L': 0.0714},
"a13": {'TOP': 0.0625, 'H': 0.3333, 'M': 1.0, 'L': 0.0667},
"a14": {'TOP': 0.0526, 'H': 0.0667, 'M': 0.25, 'L': 0.1667},
"a15": {'TOP': 0.0667, 'H': 0.1111, 'M': 0.1429, 'L': 0.05},
"a16": {'TOP': 0.25, 'H': 0.2, 'M': 0.1667, 'L': 1.0},
"a17":{'TOP': 1.0, 'H': 0.1667, 'M': 0.0769, 'L': 0.2},
"a18":{'TOP': 0.5, 'H': 0.2, 'M': 0.0556, 'L': 0.0714},
"a21":{'TOP': 0.3333, 'H': 0.5, 'M': 1.0, 'L': 0.1},
"a22":{'TOP': 0.125, 'H': 0.0526, 'M': 0.0909, 'L': 0.1429},
"a23":{'TOP': 0.0667, 'H': 1.0, 'M': 0.1111, 'L': 1.0},
"a24":{'TOP': 0.0526, 'H': 0.1, 'M': 1.0, 'L': 0.05},
"a25":{'TOP': 0.5, 'H': 0.25, 'M': 0.0833, 'L': 0.0588},
"a26":{'TOP': 0.0556, 'H': 0.0909, 'M': 0.1667, 'L': 0.1},
"a27":{'TOP': 0.0625, 'H': 0.0667, 'M': 0.0833, 'L': 0.5},
"a28":{'TOP': 0.0588, 'H': 0.0667, 'M': 0.3333, 'L': 0.05},
"a31":{'TOP': 0.0625, 'H': 0.0556, 'M': 0.0714, 'L': 0.05},
"a32":{'TOP': 0.0909, 'H': 0.125, 'M': 0.0769, 'L': 1.0},
"a33":{'TOP': 0.0667, 'H': 0.0833, 'M': 0.1111, 'L': 0.2},
"a34":{'TOP': 0.0714, 'H': 0.05, 'M': 0.2, 'L': 0.0833},
"a35":{'TOP': 0.125, 'H': 0.25, 'M': 0.0556, 'L': 0.1},
"a36":{'TOP': 0.1, 'H': 0.0625, 'M': 0.1, 'L': 0.0556},
"a37":{'TOP': 0.0625, 'H': 0.0714, 'M': 0.0667, 'L': 0.3333},
"a38":{'TOP': 0.0588, 'H': 0.125, 'M': 0.25, 'L': 0.1667},
"a41":{'TOP': 0.2, 'H': 0.1111, 'M': 0.1111, 'L': 0.25},
"a42":{'TOP': 0.0625, 'H': 0.1, 'M': 0.0909, 'L': 0.2},
"a43":{'TOP': 0.1429, 'H': 0.1, 'M': 0.05, 'L': 0.0625},
"a44":{'TOP': 0.1429, 'H': 0.25, 'M': 0.2, 'L': 0.2},
"a45":{'TOP': 1.0, 'H': 0.0714, 'M': 0.0526, 'L': 0.0625},
"a46":{'TOP': 0.0769, 'H': 0.0526, 'M': 0.2, 'L': 0.125},
"a47":{'TOP': 0.125, 'H': 0.1429, 'M': 0.1, 'L': 1.0},
"a48":{'TOP': 0.0556, 'H': 0.0833, 'M': 0.1, 'L': 0.0833},
"a51":{'TOP': 0.0833, 'H': 0.1, 'M': 0.0667, 'L': 0.1111},
"a52":{'TOP': 0.0667, 'H': 0.0625, 'M': 0.0526, 'L': 0.0588},
"a53":{'TOP': 0.1111, 'H': 0.1429, 'M': 0.2, 'L': 1.0},
"a54":{'TOP': 0.3333, 'H': 0.0526, 'M': 0.0625, 'L': 0.125},
"a55":{'TOP': 0.0526, 'H': 1.0, 'M': 0.05, 'L': 0.0909},
"a56":{'TOP': 0.5, 'H': 0.0625, 'M': 0.0588, 'L': 0.1667},
"a57":{'TOP': 0.2, 'H': 0.0588, 'M': 1.0, 'L': 0.1429},
"a58":{'TOP': 0.0909, 'H': 0.0909, 'M': 0.25, 'L': 0.0526},
"a61":{'TOP': 0.0833, 'H': 0.25, 'M': 0.0526, 'L': 0.0667},
"a62":{'TOP': 0.25, 'H': 0.1667, 'M': 0.0667, 'L': 0.1},
"a63":{'TOP': 0.05, 'H': 0.0833, 'M': 0.0714, 'L': 0.5},
"a64":{'TOP': 0.0833, 'H': 0.0909, 'M': 0.1429, 'L': 0.1667},
"a65":{'TOP': 0.0556, 'H': 0.125, 'M': 1.0, 'L': 0.05},
"a66":{'TOP': 0.0909, 'H': 0.5, 'M': 0.05, 'L': 0.0526},
"a67":{'TOP': 0.0909, 'H': 0.0833, 'M': 0.25, 'L': 0.1111},
"a68":{'TOP': 0.0833, 'H': 0.0714, 'M': 0.1, 'L': 0.1429},
"a71":{'TOP': 0.25, 'H': 0.0588, 'M': 0.25, 'L': 0.25},
"a72":{'TOP': 0.0526, 'H': 0.0833, 'M': 0.25, 'L': 0.0769},
"a73":{'TOP': 0.0556, 'H': 0.0714, 'M': 0.3333, 'L': 0.3333},
"a74":{'TOP': 0.1667, 'H': 0.0556, 'M': 0.25, 'L': 0.1111},
"a75":{'TOP': 0.0625, 'H': 0.0625, 'M': 0.0769, 'L': 0.0588},
"a76":{'TOP': 0.0714, 'H': 0.0714, 'M': 0.0588, 'L': 0.3333},
"a77":{'TOP': 0.0588, 'H': 0.0909, 'M': 0.0833, 'L': 1.0},
"a78":{'TOP': 0.1429, 'H': 0.3333, 'M': 0.0667, 'L': 0.0667}
}
requirement = 150
num_of_drones = 3
num_of_swarms = 2
probs0 = {'a11': {'H': 0.5, 'M': 0.5, 'L': 0},
         'a12': {'H': 0.7, 'M': 0, 'L': 0.3},
         'a13': {'H': 0.6, 'M': 0.4, 'L': 0.2},
         'a21': {'H': 0.5, 'M': 0.6, 'L': 0.3},
         'a22': {'H': 0.0, 'M': 0.3, 'L': 0.5},
         'a23': {'H': 0.5, 'M': 0.0, 'L': 0.2},
         'a31': {'H': 0.8, 'M': 0.3, 'L': 0.7},
         'a32': {'H': 0.0, 'M': 0.5, 'L': 0.2},
         'a33': {'H': 0.9, 'M': 0.0, 'L': 0.3}}

probs1 = {'a11': {'H': 1, 'M': 0, 'L': 0},
         'a12': {'H': 1, 'M': 0, 'L': 0},
         'a13': {'H': 1, 'M': 0, 'L': 0},
         'a21': {'H': 1, 'M': 0, 'L': 0},
         'a22': {'H': 1, 'M': 0, 'L': 0},
         'a23': {'H': 1, 'M': 0, 'L': 0},
         'a31': {'H': 1, 'M': 0, 'L': 0},
         'a32': {'H': 1, 'M': 0, 'L': 0},
         'a33': {'H': 1, 'M': 0, 'L': 0}}

probs2 = {'a11': {'H': 0.6, 'M': 0, 'L': 0},
         'a12': {'H': 0, 'M': 0, 'L': 0},
         'a13': {'H': 0, 'M': 0, 'L': 0},
         'a21': {'H': 0, 'M': 0.1, 'L': 0},
         'a22': {'H': 0, 'M': 0, 'L': 0.6},
         'a23': {'H': 0, 'M': 0, 'L': 0},
         'a31': {'H': 0, 'M': 0, 'L': 0.5},
         'a32': {'H': 0, 'M': 0.7, 'L': 0.1},
         'a33': {'H': 0, 'M': 0, 'L': 0}}

probs3 = {'a11': {'H': 0.6, 'M': 0, 'L': 0},
         'a12': {'H': 0, 'M': 0, 'L': 0},
         'a13': {'H': 0, 'M': 0.5, 'L': 0},
         'a21': {'H': 0, 'M': 0.1, 'L': 0},
         'a22': {'H': 0, 'M': 0, 'L': 0.6},
         'a23': {'H': 0, 'M': 0, 'L': 0},
         'a31': {'H': 0, 'M': 0, 'L': 0.5},
         'a32': {'H': 0, 'M': 0.7, 'L': 0.1},
         'a33': {'H': 0, 'M': 0, 'L': 0},
         'a41': {'H': 0.8, 'M': 0, 'L': 0},
         'a42': {'H': 0, 'M': 0.7, 'L': 0.1},
         'a43': {'H': 0, 'M': 0, 'L': 0}
          }

probs4 = {'a11': {'M': 0.0, 'L': 0},
         'a12': {'M': 0.0, 'L': 0.3},
         'a13': {'M': 0.4, 'L': 0.0},
         'a14': {'M': 0.2, 'L': 0.1},
         'a21': {'M': 0.0, 'L': 0.3},
         'a22': {'M': 0.0, 'L': 0.0},
         'a23': {'M': 0.6, 'L': 0.0},
         'a24': {'M': 0.3, 'L': 0.5},
         'a31': {'M': 0.0, 'L': 0.0},
         'a32': {'M': 0.5, 'L': 0.2},
         'a33': {'M': 0.0, 'L': 0.3},
         'a34': {'M': 0.0, 'L': 0.0},
         'a41': {'M': 0.1, 'L': 0.0},
         'a42': {'M': 0.0, 'L': 0.2},
         'a43': {'M': 0.8, 'L': 0.2},
         'a44': {'M': 0.0, 'L': 0.0}
          }


gamma = 0.9
max_reward = 2*4*sum(pests_2[p] for p in pests_2) # 18

#problem = search.SingleSwarmProblem(HOR, size_x, size_y, pests_1, probs3, max_reward, num_of_drones)
problem = search.MultiSwarmProblem(HOR, 4, 4, pests_2, probs4, max_reward, 4, 2, requirement, gamma)
search.astar_search(problem, problem.h)
#mcts.monte_carlo_tree_search(problem, 100000)
